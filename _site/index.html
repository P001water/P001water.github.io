<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta content="Hello, P001's blog!" property="og:site_name">

  <meta content="Hello, P001's blog!" property="og:title">


  <meta content="website" property="og:type">


  <meta content=" <h1>P001water@c:\Users\maylas\.ssh</h1> <h3>Do Enjoy youself in hack life</h3> --------CMD /c 这里是朴水... ... Reply from 1988 !-------" property="og:description">


  <meta content="http://localhost:4000/" property="og:url">



  <meta property="og:image" content="">



  <title>Hello, P001&#39;s blog!</title>
  <meta name="description" content=" <h1>P001water@c:\Users\maylas\.ssh</h1> <h3>Do Enjoy youself in hack life</h3> --------CMD /c 这里是朴水... ... Reply from 1988 !-------">
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script> -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  
  <!-- <link href='https://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'> -->
  <!-- <link href='https://fonts.googleapis.com/css?family=Fira+Mono' rel='stylesheet' type='text/css'> -->
  <!-- <link href='https://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'> -->
  <!-- <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,200,300,500,600,700,900' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Gentium+Basic:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Alegreya:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Lora:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Fira+Sans:400,300,500,700' rel='stylesheet' type='text/css'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-hQpvDQiCJaD2H465dQfA717v7lu5qHWtDbWNPvaTJ0ID5xnPUlVXnKzq7b8YUkbN" crossorigin="anonymous"> -->
  <link rel="canonical" href="http://localhost:4000/">
  <link rel="alternate" type="application/rss+xml" title="Hello, P001's blog!" href="http://localhost:4000/feed.xml">
</head>


  <body>
<section>
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Hello, P001's blog!</a>
    </div>
    

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        
        
        <li><a href="/Lnk/">Lnk</a></li>
        
        
        
        <li><a href="/about/">About</a></li>
        
        
        
        
        
        
        
        


      </ul>

    <!--  <ul class="nav navbar-nav navbar-right">
        <li><a href="#">Know More!</a></li>

      </ul>-->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
</section>

<section>
<section>
  <div class="jumbotron">
    <div class="container">
       <h1>P001water@c:\Users\maylas\.ssh</h1> <h3>Do Enjoy youself in hack life</h3> --------CMD /c 这里是朴水... ... Reply from 1988 !-------

    </div>

</div>
</section>

<section id="page-content">
  <div class="container">
    <div class="post-list">
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/hvv/2023/08/25/Hvv%E6%BC%AB%E6%B8%B8%E6%97%A5%E8%AE%B0%E4%B8%8E%E6%80%9D%E8%80%83.html" > 2023 Hvv漫游日记与思考</a>
    </div>
    <div class="post-excerpt">
      那些年我们护网的日子…… 一、探路 Hvv的路还是有些曲折的，很多zj在卡年龄，薪资之类的。 毕竟这东西在现场，也只是少部分能干活的人干活。所以慢慢给大多数人的印象就是不需要干活。如果不需要干活，不就一定程度上说明这届红队不太行嘛。 也面试了不少中介，有的中介出于卡薪资的心态，会问很多rt中高的内容，cs，操作系统原理都得给你来点儿，甚至整场面试不涉及蓝队相关的内容，最后随便问两个流量特征草草了之，这种纯纯卡人卡钱的都是**，还得是gy。不过不用被问的emo，毕竟我们和中介是双向选择，找下家就行了。 说是薪资低了，实际上是他们赚的更多了。想拿高点的话就做好能干活的准备，找找学校工作的学长也可能有门路，但也可能被不当人一天发三百。还是那句话，没人脉就拿实力拿钱，没实力拿人脉换钱，又有实力又有人脉就活该你拿钱。 二、上路 最后还是成功上车了，360，面向某省单位。大哥说还是很轻松的，活少钱多。于是准备愉快的当猴子了。 到地方了刚和销售对接上（后来才知道可能是项目经理才和销售对接）。当时我问销售：“姐，这次咱们谁主防，听谁的”，姐 热络的：“这次咱们主防啊，都听你的，待会儿还会给你配几个人”。当时我噎了一下，心里直接麻了，这台本来之前可没对过啊，我tm成真身了。硬着头皮上去了。幸亏咱能扯，和信息中心的老大哥们扯东扯西能对付过去。 三、经历 总的下来，个人觉得打一场蓝队对未来的RT们来说还是很有必要的，当然前提是能发挥点作用的职位。如果是个应急岗，也能收获不少，毕竟哪有那么多的应急真实环境让你锻炼，可以说都是喂出来的。 整场hvv下来，让我看见了一个真实环境下的极大的业务网络拓扑情况和当前肯下功夫的防守方所做的防御建设（zf单位，舍得在安全建设上花钱）。因为是主防，所以大哥很耐心的给我讲解整个的网络拓扑分配。 设备情况应该各家单位大差不差： 防火墙 防火墙基本都是上的硬件防火墙，策略也是白名单，流量入口出口给你限制的死死的。老大哥甚至能清楚的说出对每一块区域甚至单个主机配的策略，md他那主机策略几百条来着，因为下边单位众多，配的相对详细。据他说没优化前可能更多。手动苦笑 态势感知 各家的产品一般都是放个探针的在流量出口，一般是交换机等等上。然后数据由探针上报到态势感知分析展示。后来老大哥们甚至想统筹全省，搁下属单位都放个探索，上报流量。这样一算我还可能帮销售卖出几百万设备：） 上网行为管理软件 额，最出名的就是深信服的了，听老大哥说深信服在此深耕数十年，附带有邮件收发管理，钓鱼邮件检测。记得刚开始第一天就来了个钓鱼邮件，也是深信服的检测到的。...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Friday, August 25, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        hvv &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/2023/07/25/Hello!-Java-SEC.html" > 7.25 —— Hello!  Java SEC</a>
    </div>
    <div class="post-excerpt">
      这两天好像出鬼了，对于Java我好像突然顿悟了。以前死看不懂的Java代码突然理解了。架构，模式在脑子里都更清晰了，看代码终于是有头绪了。（可能是最近给我的国外研究生学生上课，蹭了他们JavaSEC Spring的课件、加上又学了遍Java SE） 说起来，最近都在摸.net和Java，接触下来的感觉就是这两门语言的思想和语法都十分相似。 .net是为了理解内网的一些工具学的，Java则是大势所趋（Java这一套快赶上”苹果的生态“了） 学习Java反序列化，我的建议是也得先重点看看Java的IO流，这块是真的麻烦，在反序列化的理解中也挺重要。并且IO流这一块也是其他很多语言没有突出的地方，很多语言把IO流封装的很好，Java是把这块儿甩给开发者了。 谨以此文，记录我的Java学习历程 CC1-7 链 我看过很多遍了，这两天才tm真懂了。后面准备多看看链子了。 CC链 1-7 分析 - 先知社区 (aliyun.com) 反序列化流程分析 我本身正是想跟一遍下面的内容，看看怎么从inputStream.readObject();到类里Override重写的readObject()的 ObjectInputStream inputStream...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Tuesday, July 25, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/potatoes%E5%AE%B6%E6%97%8F/2023/07/24/Windows%E5%91%BD%E5%90%8D%E7%AE%A1%E9%81%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A8%A1%E6%8B%9F%E5%92%8CPrintSpoofer%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6.html" > Windows命名管道客户端模拟和PrintSpoofer原理探究</a>
    </div>
    <div class="post-excerpt">
      文章首发于Seebug Paper Windows 命名管道客户端模拟和 PrintSpoofer 原理探究 (seebug.org) 前言 在Windows的实际渗透中，提权方面我们最常用到的就是众多的土豆家族 关于各种土豆的原理，似乎很多人印象中一直都是这样：利用COM interface的某些特性，诱骗具有System权限的帐户连接我们可控的RPC服务端进行身份验证，然后NTLM relay的过程，拿到System的权限。 现实是，基于这种想法利用的potatoes在win10 1089和server 2019之后基本都已失效了，现在正火热的RoguePotato (NG)，Sweetpotato(集成了Printspoofer等)，BadPotato，GodPotato等，都是结合了命名管道客户端模拟的老技术 命名管道客户端模拟（Named_Pipe_Client_Impersonation）可以说是中后期土豆家族的关键之处，由于微软官方认为从具有SeImpersonate privilege特权的Windows服务账户提升至 NT AUTHORITY/SYSTEM...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Monday, July 24, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        Potatoes家族 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E9%82%AE%E4%BB%B6%E9%92%93%E9%B1%BC/2023/07/08/%E7%BA%A2%E9%98%9F%E9%82%AE%E5%B7%AE-%E9%82%AE%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE%E5%92%8CSwaks%E4%BC%AA%E9%80%A0%E9%82%AE%E4%BB%B6.html" > 红队邮差-邮件安全协议和Swaks伪造邮件</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 打不进去，研究研究钓鱼，21年的DataCon有这个内容，按照paper来的 DataCon2021优秀解题思路分享-邮件发件人伪造（武汉大学 10TG） – DataCon社区 (qianxin.com) 钓鱼邮件还是关注两部分的内容，发件人伪造和如何不进垃圾箱。 0x01 前言 邮件发件协议主要是SMTP(Simple Mail Transfer Protocol)，但是SMTP协议设计之初并没有考虑到太多安全相关的功能，因此导致邮件发件人伪造的攻击层出不穷。 一个典型的邮件从发送方编写到接收方看到邮件内容的过程如下图所示 邮件发送流程图 发送方通过SMTP协议发给发送方的MTA(Mail Transmission Agent) 发送方的MTA通过SMTP协议发给接收方的MTA...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Saturday, July 8, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        邮件钓鱼 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/vx%E5%B0%8F%E7%A8%8B%E5%BA%8F/2023/07/03/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-vx%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90%E5%92%8C%E5%8F%8D%E7%BC%96%E8%AF%91%E6%8B%BF%E6%BA%90%E7%A0%81.html" > 渗透技巧-vx小程序实例分析和反编译拿源码</a>
    </div>
    <div class="post-excerpt">
      前言 无论是攻防演练还是SRC挖掘，小程序渗透测试已经成为了传统web打点之外、信息收集的重要一步。 17年微信小程序上线，vx小程序的定位是一种全新的连接用户与服务的方式，它可以在微信内被便捷地获取和传播，同时具有出色的使用体验 小程序并非凭空冒出来的一个概念。当微信中的 WebView 逐渐成为移动 Web 的一个重要入口时，微信就有相关的 JS API 了。 它的主要开发语言也是 JavaScript ，小程序的开发同普通的网页开发相比有很大的相似性。因为是JavaScript，所以还是基于用户端运行，也就出现了小程序反编译导致信息泄露的可能。下面就从一个实际项目了解vx小程序的项目结构 小程序项目结构 项目地址：yllg/WXxcx: 微信小程序-e生活 在微信开发者工具中导入e生活项目，打开后IDE自动开启热加载 小程序包含一个描述整体程序的 app...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Monday, July 3, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        vx小程序 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E4%BA%91%E5%AE%89%E5%85%A8/2023/06/12/%E4%BA%91%E4%B8%8A-%E4%BA%91%E4%B8%8A%E5%A4%87%E5%BF%98%E5%BD%95%E5%92%8C%E6%9D%82%E5%AD%A6.html" > 云上-云上备忘录和杂学</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 个人感觉，做云一定要简单看下云官方的SDK文档，也可以看别人产出总结出的文章。你看不懂的“黑话”，可能在官方的文档里都有详细的解释。 对头部的云厂商是这样，私有云肯定也是。著名的CF框架，就是拿到AK后，从开发者的角度利用账户的权限对云上的主机进行批量操作，这本身也是云厂商给客户的正常功能。说白了就是我们接管，“帮运维干活”。 本文记录和介绍云厂商通用概念、云上、学习SDK开发文档遇见的内容。 Access Key 为了保障云主机的安全性，各家云在API调用时均需要验证访问者的身份，以确保访问者具有相关权限。这种验证方式通过Access Key来实现，Access Key由用户自己创建，各家云颁发给云主机的所有者，它由Access Key ID和Access Key Secret构成，其重要性等同于用户的登录密码，代表了账号所有者的身份以及对应的权限。 拿腾讯云举例，其他云厂商都差不多，访问路径： 云产品 &gt; 管理与审计 &gt; 访问密钥 （From...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Monday, June 12, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        云安全 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7/2023/06/12/%E7%94%A8python%E8%B5%B7%E4%B8%80%E4%B8%AAhttps%E6%9C%8D%E5%8A%A1%E5%99%A8.html" > 渗透技巧——用python简单起个https服务器</a>
    </div>
    <div class="post-excerpt">
      文章首发于用python简单起个https服务器 - 先知社区 (aliyun.com) 前言 偶然碰见的很有意思的内容 平时我们经常有起个http服务器的需求，一般是 python -m http.server port，很明显，这样的文件下载时是明文传输的 访问本地起的http服务 wireshark捕获下，http的内容是直接可见的 这时候考虑加个网站ssl证书把http &gt; https，也就是自签名，反正也是访问我们自己的服务，下面是python代码实现，小改动自，Yicong – Medium 自己可以根据需求改动签名中的信息，比如甩锅啥的 #...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Monday, June 12, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        渗透技巧 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/ctf/awd%E7%BA%BF%E4%B8%8B/2023/06/11/%E4%B8%8A%E6%B5%B7%E4%B8%9C%E5%8D%8E%E5%A4%A7%E5%AD%A6-AWD%E7%A3%90%E7%9F%B3%E8%A1%8C%E5%8A%A8%E4%B9%8B%E6%97%85.html" > CTF——上海东华大学-AWD磐石行动之旅</a>
    </div>
    <div class="post-excerpt">
      About competition 第二次打AWD了，但其实和第一次没什么差别，不仅是队友换了。为什么呢，这个我想了下，后面有机会再说吧 环境给了四台靶机，两台pwn，两台web，web一台php的，一台java的 前期靠着手快，打了个第二，md忘了截图了，哈哈 中后期就撑不住了。我们三个web，pwn靶机没人修，也不会修，：——） 靠着审代码和抓流量，拿到几个洞，也都上了批量脚本了，基本每轮都开始自动攻击了，但是得分比不上扣分，排名直线下降 比完了想明白了 是所有攻破的团队共享这50分，所以要想上大分，不仅要自己拿到flag，还要让别人拿不到flag，：）。交大哥们真是一语惊醒梦中人 所以权限维持做的好就很重要，后门做好了，要是人家还把站删了你就高兴坏了，分全是你的 php是tp5的，java就是spingboot的，洞也不是很难，所以多熟悉下这种mvc框架对应的具体原理，比如路由，控制器原理什么的，不然你抓到对面的流量但是找不到对应文件的位置就尴尬了，那还怎么修呢 个人感觉AWD还是很有意思的，但是这种比赛的体验度纯看主办方的实力和参赛选手的准备程度。主办方不行，平台卡的一批；参赛选手实力层次不齐，很容易出现强队打全场，其余纯坐牢的问题。 Something inter 上海的物价还是高呀，同样的三四百一晚的酒店，住了个格子间。这是酒店里的不知名恐怖 外滩没去成，正赶上下雨了，就先撤了，群友的图。 去的路上杨哥坐地铁还做反了，说实话我还不清楚这搁地上跑的还叫不叫地铁，或许叫城市轻轨，哈哈 酒店边上的社区食堂伙食真不错，价格也舒服。学校食堂要是有着，天天早上跳起来吃早餐 在这里吃饭的大爷大妈都很熟络，是个很舒服的社区啊。一个奶奶热心的教我们怎么吃汤包，太腼腆了没来得及说声蟹蟹，哈哈 运气好，回来没赶上雷暴雨...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Sunday, June 11, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        CTF &nbsp;,
        
        AWD线下 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E5%8F%96%E8%AF%81/windows%20dpapi/2023/05/12/Chrome%E6%B5%8F%E8%A7%88%E5%99%A8%E5%87%AD%E6%8D%AE%E7%AA%83%E5%8F%96%E5%92%8CC-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0.html" > 渗透取证技巧--Chrome浏览器密码凭据窃取和C#实现</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 权限维持的重要步骤，抓密码。本文通过对Windows DPAPI的基本认识和chrome密码加密机制的理解基础上，编写C#代码实现对chrome浏览器密码的解密 实际利用下，最好是通过go，c/c++这种改写或者编到cs的插件中，基于.net平台还是有点麻烦，得准备两三个版本。 Chrome的加密过程 将用户保存的账户密码使用AES GCM加密 将AES加密密钥通过Windows DPAPI加密保存在名为Local State的文件中，文件以json格式存储。 将初始化向量与密文连接起来，并将它们保存在名为Login Data的文件中，文件以sqlite数据库形式存储。 Local State——加密密钥存放的位置 %USERPROFILE%\AppData\Local\Google\Chrome\User Data\Login Data 文件以json格式储存，encrypted_key 的值就是Windows dpapi加密过后的AES密钥...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Friday, May 12, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        取证 &nbsp;,
        
        windows DPAPI &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E5%8F%96%E8%AF%81/windows%20dpapi/2023/05/12/Windows%E6%95%B0%E6%8D%AE%E4%BF%9D%E6%8A%A4%E6%8E%A5%E5%8F%A3-DBAPI.html" > 渗透取证技巧--Windows数据保护接口——DPAPI</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 DPAPI Data Protection Application Programming Interface 数据保护应用程序编程接口 ​ 这是windows贴心的为开发者提供的针对用户身份加密的方案——DPAPI。win程序开发者可以方便的使用该API加密保护敏感数据，这种基于用户身份的加密使得该加密数据仅可被对数据进行加密的用户解密，它是Windows中保护敏感数据的首选API之一，被广泛应用于各种应用程序数据保护部分。 DPAPI提供了两种方法：基于用户和基于机器的加密。在基于用户的加密中，系统会根据用户的凭据生成一个唯一的主密钥，并将其存储在用户的配置文件中。此主密钥用于加密和解密用户的私密数据。在基于机器的加密中，系统会根据计算机的凭据生成一个唯一的主密钥，并将其存储在本地计算机上。此主密钥用于加密和解密系统级别的数据。 DPAPI针对用户身份加密的方案可以抽象理解为，不同用户拥有不同的DPAPI master key，一个用户也可能有不同的master key，这个DPAPI master key 相当于一个密钥，这个调用`DPAPI master key实施加密的过程由系统直接操作，相当于Windows给开发者封装了个加密算法，直接调用就能实现的敏感数据的加密解密保护...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Friday, May 12, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        取证 &nbsp;,
        
        windows DPAPI &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/2023/04/27/Godzilla-%E4%BB%8E%E4%B8%89%E7%A7%8D%E8%87%AA%E5%B8%A6%E5%8A%A0%E5%AF%86%E5%99%A8%E7%9C%8B%E5%93%A5%E6%96%AF%E6%8B%89%E6%B5%81%E9%87%8F-PHP%E7%AF%87.html" > Godzilla-从三种自带加密器看哥斯拉流量-PHP篇</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 Godzilla - designed by @BeichenDreams 本文记录我对哥斯拉流量的学习，主要分析了php版的shell流量加密解密过程，使用的是当前最新版本的哥斯拉，版本号为v4.01。 三种自带的加密器 生成Godzillz默认的服务端webshell，自带有三种加密器： PHP_EVAL_XOR_BASE64 PHP_XOR_BASE64 PHP_XOR_RAW PHP_XOR_BASE64加密器 笔者觉得应该从这种加密器先讲起，后面的PHP_EVAL_XOR_BASE64等加密器实现原理和它都相同，只是传输形式上的差别。 从http请求的角度看，PHP_XOR_BASE64加密器和PHP_EVAL_XOR_BASE64加密器的区别就是，命令执行的过程中，PHP_XOR_BASE64加密器的http请求正文长度（payload）更短，PHP_EVAL_XOR_BASE64加密器生成的shell服务端的内容就是一句话木马，这个加密器其实还是调用``PHP_XOR_BASE64`加密器的webshell脚本 用Godzilla的PHP_XOR_BASE64加密器生成的webshell内容 整个shell的基本流程就是：服务器接收到哥斯拉发送的第一个请求后，如果此时尚未建立session，将POST请求数据解密后（得到的内容为后续shell操作中所需要用到的相关php函数定义代码）存入session文件中，会话建立完成后，后续哥斯拉只会提交相关操作对应的函数名称和相关参数，这样哥斯拉的命令执行就不需要发送大量的请求数据。 这里的@run()函数是关键，后续的命令执行都以这个函数为入口 存储哥斯拉自定义命令执行函数的session文件 ......
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Thursday, April 27, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        流量分析 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/ntlm/2023/04/17/Net-NTLMv2%E7%AA%83%E5%8F%96-By-Outlook-NTLM-Leak.html" > 漏洞追踪————Net-NTLMv2窃取----By Outlook NTLM Leak</a>
    </div>
    <div class="post-excerpt">
      
  文章首发先知社区

  [Net-NTLMv2窃取—-By Outlook NTLM Leak]


后续可能会更新更新

    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Monday, April 17, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        NTLM &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/php/2023/04/07/%E4%BC%AA%E5%8D%8F%E8%AE%AEphp-input%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E5%8E%9F%E7%90%86.html" > webshell分析————伪协议php://input命令执行的原理</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 文章首发在Freebuf 研究几种webshell管理工具时遇见，发现几款常见的webshell管理工具都有对php://input的利用 本文记录我对php://input原理的学习和思考，如有疏漏失错，还请联系告知 $HTTP_RAW_POST_DATA的作用和php://input的作用相同，但是PHP 5.6.0. 被废弃了，后面的版本中就是用php://input替代。所有本文省略 官方文档的解释 $_POST数组 当 HTTP POST 请求的 Content-Type 是 application/x-www-form-urlencoded或 multipart/form-data时，会将变量以关联数组形式传入当前脚本。 php://input 伪协议 php://input...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Friday, April 7, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        PHP &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/vol2/3/2023/03/12/volatility23%E5%91%BD%E4%BB%A4%E5%B0%8F%E8%AE%B0%E5%92%8C%E9%97%B2%E8%B0%88.html" > CTF---volatility2/3命令小记和闲谈</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 本文记录vol2/3常用命令，同时记录我的使用样例。以前初学时写过一篇，但是太过臃肿了，精简一下方便查阅。 从CTF的角度，取证和流量分析的题目一定是越来越多的，可能和“我们”的大方向有关，毕竟我们“攻是为了防”； 从渗透的角度，取证和流量分析大概是Misc里和渗透关系最近的。chrome浏览器的密码解密、Windows的DPAPI机制、webshell加密和解密流量分析等等，比找个工具跑跑脚本就从图片里提出个flag有意思，也更有意义。 取证是个各显神通的方向，显神通指的就是各位用的是哪家厂商的设备，这种东西事半功倍的效果立竿见影，也就是博客里常见的“一把嗦”。瞎扯了 简介 内存取证各家似乎都没有好用的产品，记得某古石，取个正常的内存进行要扫半个小时往上 建议去看看R-Studio，一款数据恢复软件，结合内存取证有奇效，其他的就看经验和积累了。比如，好东西总是在桌面上，如果不在，就骂出题人吧 闲谈结束，下面也就是我记得命令笔记了，没啥好看的 Vol2 离线手册：Volatility Cheat Sheet to make sure Volatility supports that sample...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Sunday, March 12, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        内存取证 &nbsp;,
        
        vol2/3 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/2023/01/15/%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90(1)-%E7%AE%80%E5%8D%95%E8%A7%A3%E5%AF%86%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F.html" > 流量分析——简单解密蚁剑流量</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 在学习Godzaill流量的时候，我发现了批量解密流量包流量的新思路——py的mitmproxy模块，中间人攻击（Man-in-the-middle attack）的意思 mitmproxy模块就相当于py里的burp suite，更有用的是它支持我们自定义脚本处理http的请求和响应内容（在mitmproxy里叫addon脚本），这正好解决了我的大问题 mitmproxy安装后有 3 个命令行工具：mitmproxy, mitmdump, mitmweb mitmproxy：交互式；查看流量数据 (请求与响应)；执行自定义脚本 mitmdump：执行自定义脚本，脚本在 Mitmproxy 中叫做 Addon mitmweb：mitmweb是一个基于Web的用户界面，用于与mitmproxy交互和监视HTTP / HTTPS流量。它使开发人员能够更轻松地查看和分析代理拦截的网络流量。 用mitmproxy分析抓包很方便...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Sunday, January 15, 2023
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        流量分析 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/redis%E6%9C%AA%E6%8E%88%E6%9D%83/2022/11/14/%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%85%B8-Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E%E4%B8%8E%E7%BB%84%E5%90%88%E6%8B%B3.html" > 实战打点————面试经典 Redis未授权漏洞与组合拳</a>
    </div>
    <div class="post-excerpt">
      
  文章首发freebuf

  面试经典 Redis未授权漏洞与组合拳



    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Monday, November 14, 2022
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        Redis未授权 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/writeup/2022/11/12/BuckeyeCTF-2022-writeup.html" > CTF---BuckeyeCTF-2022-writeup</a>
    </div>
    <div class="post-excerpt">
      文前漫谈 比赛地址：https://pwnoh.io/challs Web buckeyenotes/beginner des：Note taking apps are all the rage lately but turns our they’re harder to make than...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Saturday, November 12, 2022
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        writeup &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-%E6%9E%84%E5%BB%BAprofile/2022/11/04/%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8Evolatility2%E6%9E%84%E5%BB%BA-%E6%96%B0-%E7%89%88%E6%9C%AC%E5%86%85%E6%A0%B8%E7%9A%84profile.html" > CTF---如何基于volatility2构建“新”版本内核的profile</a>
    </div>
    <div class="post-excerpt">
      
  取证里算不上难，但是也算中等难度。这种题只能只能出一次

  文章发在跳跳糖上了



    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Friday, November 4, 2022
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        内存取证-构建profile &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E6%8F%90%E6%9D%83/2022/10/31/2022%E8%93%9D%E5%B8%BD%E6%9D%AF%E9%81%87%E8%A7%81%E7%9A%84-SUID-%E6%8F%90%E6%9D%83.html" > 2022蓝帽杯遇见的SUID提权</a>
    </div>
    <div class="post-excerpt">
      感谢我糖，文章发在跳跳糖上了 当时写的太麻烦， 三个命令完事上网站看看有没有可利用的文件，GTFOBins find / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null find /...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Monday, October 31, 2022
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        提权 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/usb/2022/10/12/CTF%E4%B8%AD%E6%88%91%E7%9A%84USB%E9%94%AE%E7%9B%98%E9%BC%A0%E6%A0%87%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86%E6%8C%87%E5%8D%97%E5%92%8C%E8%84%9A%E6%9C%AC.html" > CTF---CTF中我的USB键盘鼠标流量解密指南和脚本</a>
    </div>
    <div class="post-excerpt">
      文章首发于freebuf 文前漫谈 2023-5-27更新 整理博客，说点感想吧。从脚本搞定到现在，已经两三场比赛遇见了，如果看了下脚本源码和对USB稍加学习应该是秒杀的。有点惆怅的是什么呢，本来这个脚本是在校队内部分享的，可是没人看，就放出来了。 到现在搜索引擎的第一位，freebuf上浏览量也十八万（实际也得除以10）了。很多师傅也在用，甚至可以一把梭。可是最初分享的那些好像根本看不见，哈哈。觉得挺没劲的，所以几次分享都懒得准备了，应付应付就算了。最近有点惆怅，说的有点多。 对ctf中的USB做一个了断吧，先摆上一些概念性的东西 USB是 UniversalSerial Bus（通用串行总线）的缩写，是一个外部总线标准，用于规范电脑与外部设备的连接和通讯，例如键盘、鼠标、打印机、磁盘或网络适配器等等。通过对该接口流量的监听，我们可以得到取键盘敲击键、鼠标移动与点击、存储设备的铭文传输通信、USB无线网卡网络传输内容等等。 USB的几种用途 现在USB协议版本有USB2.0, USB3.1,USB3.2, USB4等，目前USB2.0/3.0比较常用，你在淘宝上买U盘的时候可能看见过很多“USB 3.0”。 闲谈哈，你可能听过USB3.1的概念，是某苹果为了装逼提出来的，跟USB3.0差别不大，但是人家是老大哥啊，所有慢慢都向大哥看齐，都流行说USB3.1 USB UART 异步串行通信口(UART)就是我们在嵌入式中常说的串口，它还是一种通用的数据通信协议。这种方式下，设备只是简单的将 USB 用于接受和发射数据，除此之外就再没有其他通讯功能了。...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Wednesday, October 12, 2022
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        流量分析 &nbsp;,
        
        USB &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E7%9E%8E%E6%8A%98%E8%85%BE/cheatsheet/2022/08/10/CheatSheet.html" > My CheatSheet</a>
    </div>
    <div class="post-excerpt">
      正则表达式速查卡 Website collect User Agent String.Com —— 收集各种UA头 [Civitai Stable Diffusion models, embeddings, hypernetworks and more](https://civitai.com/) —— ai图片模型 Docker Error...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Wednesday, August 10, 2022
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        瞎折腾 &nbsp;,
        
        CheatSheet &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/%E7%9E%8E%E6%8A%98%E8%85%BE/%E6%AF%94%E8%B5%9B%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA/2022/08/07/Python-ctf%E8%B5%9B%E4%BA%8B%E9%80%9A%E7%9F%A5%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%A3%9E%E4%B9%A6%E7%89%88.html" > CTF---Python-ctf赛事通知机器人（飞书版）</a>
    </div>
    <div class="post-excerpt">
      用的ctfhub的接口，分两个模块，放在云服务器上定时运行 本来想美化一下赛事发布的消息，增加比赛简介什么的，没啥精力折腾了（可能也没啥人看） 有需要的话，可以整合一下ctftime的赛事通知 import requests import re import time import json import hashlib import base64 import hmac from datetime import...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Sunday, August 7, 2022
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        瞎折腾 &nbsp;,
        
        比赛通知机器人 &nbsp;
        
      </span>
    </div>
  </div>
  
  <div class="post-box">
    <div class="post-title">
    <a class="post-title" href="/pythonsec/ssti/2022/07/24/pythonweb-SSTI%E7%9A%84payload%E6%9E%84%E9%80%A0%E6%80%9D%E8%B7%AF%E7%A0%94%E7%A9%B6-%E5%9F%BA%E7%A1%80%E7%AF%87.html" > CTF---Pythonweb SSTI的payload构造思路研究(基础篇)</a>
    </div>
    <div class="post-excerpt">
      在freebuf上发过，这里的是精简入门版 文前漫谈 是一篇基础篇嘛，给新同学入门用，从payload的角度看看SSTI 从原点出发 你会发现，大多数payload总是从下面这段代码出发，延伸出各种各样的花样。而这一步的目的是得到当前模块中所有可以利用的类。得到的结果跟当前模块（py文件）import的库也是有关系的。 ''.__class__.__base__.__subclasses__() 详细解释： ''，是一个字符串对象，type('')的结果是&lt;class 'str'&gt;，在python中，一切皆对象，再比如type([])的结果是&lt;class 'list'&gt;，因为[]是数组的标志 __class__，是这个对象所属的类，到这一步，''.__class__的结果仍然是&lt;class 'str'&gt; ''.__class__和''，区别在于前者是个类，后者是个对象 __base__，是获得指定类的基类（父类），这里''.__class__.__base__的结果是&lt;class 'object'&gt;，因为在python3中，所有类都默认继承了Object类。 __subclasses__() ，__subclasses__()是Object类的静态方法，获得指定类的所有子类，返回一个列表。因为是个方法，所以后面的括号不能忘了带。在这个列表里，拿到了所有继承Object类的子类，而在python3里，几乎所有的内建类都继承了Object类，所以在下一步的构造中几乎所有的内置类我们都能找到并利用。 拿一个Payload研究 尝试直接在代码中（最好在flask环境下）print("".__class__.__base__.__subclasses__()[128].__init__.__globals__['popen']('whoami').read())。是不是成功执行"whoami"了。也有可能你那报错了。比如，这是因为你从''.__class__.__base__.__subclasses__()这一步拿到的子类列表，索引为128的类对应的不是os._wrap_close类，因为从这一步我们没有进入os模块所在的地址空间，就不能通过__globals__得到os模块已经加载的可利用类 补充一下...
    </div>
    <div class="posted">
      posted on
      <span class="posted-on">

        Sunday, July 24, 2022
      </span>
      <span class="in">
        in
      </span>
      <span class="categories-on">
        
        PythonSEC &nbsp;,
        
        SSTI &nbsp;
        
      </span>
    </div>
  </div>
  
  </div>
</section>

</section>
<nav class="navbar navbar-default navbar-fixed-bottom">
  <div class="container footer-content">
    Happy with <i class ="fa fa-heart"></i> by P001water<br>
    Powered By May1as 
  </div>
</nav>

  </body>

</html>
